(function(){'use strict';function getRelativePrefix(){const path=window.location.pathname;if(path.includes('/pages/')){const pathParts=path.split('/');const pagesIndex=pathParts.indexOf('pages');// Check if we are in a sub-subfolder(e.g.,/pages/blogs/post.html)if(pagesIndex !==-1 && pagesIndex < pathParts.length-2){return '../../';}return '../';}return '';}const prefix=getRelativePrefix();async function loadComponent(id,fileName){const container=document.getElementById(id);if(!container)return false;try{const response=await fetch(prefix+'components/'+fileName);if(!response.ok)throw new Error(`Failed to load ${fileName}`);const html=await response.text();container.innerHTML=html;return true;}catch(error){console.error(`Error loading component ${fileName}:`,error);return false;}}function initTheme(){// Find existing theme toggle script or load it if(!window.initThemeToggle && !document.querySelector('script[src*="theme-toggle.js"]')){const themeScript=document.createElement('script');themeScript.src=prefix+'js/global/theme-toggle.js';themeScript.onload=()=>{// If the script exposes EcoLifeTheme,use that,otherwise use initThemeToggle if available if(window.EcoLifeTheme && typeof window.EcoLifeTheme.init==='function'){window.EcoLifeTheme.init();}else if(typeof window.initThemeToggle==='function'){window.initThemeToggle();}};document.head.appendChild(themeScript);}else if(typeof window.initThemeToggle==='function'){window.initThemeToggle();}else if(window.EcoLifeTheme && typeof window.EcoLifeTheme.init==='function'){window.EcoLifeTheme.init();}// Load font-size-changer.js if not already present if(!window.initFontSizeChanger && !document.querySelector('script[src*="font-size-changer.js"]')){const fontSizeScript=document.createElement('script');fontSizeScript.src=prefix+'js/global/font-size-changer.js';document.head.appendChild(fontSizeScript);}}async function setupNavbar(){const success=await loadComponent('navbar-container','navbar.html');if(!success)return;const navbarContainer=document.getElementById('navbar-container');const isLoggedIn=localStorage.getItem('isLoggedIn')==='true';navbarContainer.setAttribute('data-logged-in',isLoggedIn);// Hide Login/Signup if on those pages const currentPage=window.location.pathname.toLowerCase();if(!isLoggedIn){if(currentPage.includes('login.html')){const btn=navbarContainer.querySelector('.btn-login');if(btn)btn.style.display='none';}else if(currentPage.includes('signup.html')){const btn=navbarContainer.querySelector('.btn-signup');if(btn)btn.style.display='none';}}// Fix Navbar Paths(Links and Images)if(prefix){const links=navbarContainer.querySelectorAll('a');const images=navbarContainer.querySelectorAll('img');links.forEach(link=>{const href=link.getAttribute('href');if(href && !href.startsWith('http')&& !href.startsWith('#')&& !href.startsWith('mailto:')){link.setAttribute('href',prefix+href);}});images.forEach(img=>{const src=img.getAttribute('src');if(src && !src.startsWith('http')){img.setAttribute('src',prefix+src);}});}// Dispatch event that navbar is ready window.dispatchEvent(new CustomEvent('navbarLoaded'));}async function setupFooter(){const success=await loadComponent('footer-placeholder','footer.html');if(!success)return;// Inject Footer CSS if missing if(!document.querySelector(`link[href*="footer.css"]`)){const link=document.createElement('link');link.rel='stylesheet';link.href=prefix+'css/components/footer.css';document.head.appendChild(link);}// Initialize Newsletter if function exists(usually in main.js or footer-loader.js)if(typeof window.initFooterNewsletter==='function'){window.initFooterNewsletter();}}async function setupCursor(){const container=document.getElementById('cursor-container');if(!container)return;const success=await loadComponent('cursor-container','cursor.html');if(!success)return;// Execute scripts inside cursor.html container.querySelectorAll("script").forEach(oldScript=>{const newScript=document.createElement("script");if(oldScript.src){newScript.src=oldScript.src;}else{newScript.textContent=oldScript.textContent;}document.body.appendChild(newScript);oldScript.remove();});}// Run when DOM is ready document.addEventListener('DOMContentLoaded',()=>{setupNavbar();setupFooter();setupCursor();initTheme();initFontSizeChanger();// Ensure FontAwesome is available if(!document.querySelector('link[href*="font-awesome"]')){const fa=document.createElement('link');fa.rel='stylesheet';fa.href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css';document.head.appendChild(fa);}});})();
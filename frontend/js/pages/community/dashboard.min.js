class EcoDashboard{constructor(){this.dashboardData=null;this.carbonChart=null;this.init();}async init(){await this.loadDashboardData();this.setupEventListeners();this.renderUserInfo();this.renderActivityOverview();this.renderFavoriteAnimals();this.renderBadges();this.renderRecentActivity();this.renderGoals();this.initializeCharts();this.setupThemeToggle();}async loadDashboardData(){try{const response=await fetch('../../assets/data/dashboard.json');this.dashboardData=await response.json();}catch(error){console.error('Error loading dashboard data:',error);// Fallback data this.dashboardData={user:{name: "EcoWarrior",level: 1,points: 0,daysActive: 1},stats:{quizzesCompleted: 0,articlesRead: 0,forumPosts: 0},favoriteAnimals: [],badges: [],recentActivity: [],goals: []};}}setupEventListeners(){// Add goal button const addGoalBtn=document.getElementById('addGoalBtn');if(addGoalBtn){addGoalBtn.addEventListener('click',()=> this.openAddGoalModal());}// Modal close buttons document.querySelectorAll('.modal-close').forEach(btn=>{btn.addEventListener('click',()=> this.closeModals());});// Add goal form const addGoalForm=document.getElementById('addGoalForm');if(addGoalForm){addGoalForm.addEventListener('submit',(e)=> this.handleAddGoal(e));}// Time range selector for carbon chart const timeRange=document.getElementById('timeRange');if(timeRange){timeRange.addEventListener('change',(e)=> this.updateCarbonChart(e.target.value));}}renderUserInfo(){const user=this.dashboardData.user;document.getElementById('userName').textContent=user.name;document.getElementById('userAvatar').src=user.avatar;document.getElementById('userLevel').textContent=user.level;document.getElementById('userPoints').textContent=user.points.toLocaleString();document.getElementById('daysActive').textContent=user.daysActive;}renderActivityOverview(){const stats=this.dashboardData.stats;document.getElementById('quizzesCompleted').textContent=stats.quizzesCompleted;document.getElementById('articlesRead').textContent=stats.articlesRead;document.getElementById('forumPosts').textContent=stats.forumPosts;// Update progress bars const quizProgress=(stats.quizzesCompleted / stats.totalQuizzes)* 100;document.getElementById('quizProgress').style.width=quizProgress+'%';// Assuming some targets for articles and forum posts const articleProgress=Math.min((stats.articlesRead / 50)* 100,100);const forumProgress=Math.min((stats.forumPosts / 30)* 100,100);document.getElementById('articleProgress').style.width=articleProgress+'%';document.getElementById('forumProgress').style.width=forumProgress+'%';}renderFavoriteAnimals(){const container=document.getElementById('favoritesGrid');const favorites=this.dashboardData.favoriteAnimals;container.innerHTML=favorites.map(animal=> ` <div class="favorite-animal" onclick="ecoDashboard.showAnimalDetails('${animal.id}')"> <div class="animal-image"> <img src="${animal.image}" alt="${animal.name}"> <div class="animal-status ${animal.status.toLowerCase()}">${animal.status}</div> </div> <div class="animal-info"> <h4>${animal.name}</h4> <p>${animal.fact}</p> </div> </div> `).join('');}renderBadges(){const container=document.getElementById('badgesGrid');const badges=this.dashboardData.badges;container.innerHTML=badges.map(badge=> ` <div class="badge-item ${badge.unlocked ? 'unlocked' : 'locked'}" title="${badge.description}"> <div class="badge-icon ${badge.rarity}">${badge.icon}</div> <div class="badge-info"> <h4>${badge.name}</h4> <p>${badge.unlocked ? 'Unlocked' : 'Locked'}</p> ${badge.unlocked ? `<small>${this.formatDate(badge.unlockedDate)}</small>` : ''}</div> </div> `).join('');document.getElementById('totalBadges').textContent=badges.filter(b=> b.unlocked).length;}renderRecentActivity(){const container=document.getElementById('activityTimeline');const activities=this.dashboardData.recentActivity;container.innerHTML=activities.map(activity=> ` <div class="timeline-item"> <div class="timeline-icon ${activity.type}">${activity.icon}</div> <div class="timeline-content"> <h4>${activity.title}</h4> <p>${activity.description}</p> <div class="timeline-meta"> <span class="timeline-date">${this.formatDate(activity.timestamp)}</span> <span class="timeline-points">+${activity.points}points</span> </div> </div> </div> `).join('');}renderGoals(){const container=document.getElementById('goalsList');const goals=this.dashboardData.goals;container.innerHTML=goals.map(goal=> ` <div class="goal-item"> <div class="goal-header"> <h4>${goal.title}</h4> <span class="goal-category ${goal.category}">${this.capitalizeFirst(goal.category)}</span> </div> <div class="goal-progress"> <div class="progress-bar"> <div class="progress-fill" style="width: ${goal.progress}%"></div> </div> <span class="progress-text">${goal.progress}% complete</span> </div> <div class="goal-meta"> <span>Target: ${this.formatDate(goal.targetDate)}</span> <span class="goal-status ${goal.status}">${this.capitalizeFirst(goal.status.replace('_',' '))}</span> </div> </div> `).join('');}initializeCharts(){this.createCarbonFootprintChart();}createCarbonFootprintChart(){const ctx=document.getElementById('carbonChart').getContext('2d');const carbonData=this.dashboardData.stats.carbonFootprint;// Update current stats document.getElementById('currentFootprint').textContent=carbonData.current;document.getElementById('footprintChange').textContent=(carbonData.change > 0 ? '+' : '')+carbonData.change+'%';document.getElementById('footprintChange').className='stat-change '+(carbonData.change < 0 ? 'positive' : 'negative');this.carbonChart=new Chart(ctx,{type: 'line',data:{labels: carbonData.history.map(item=> this.formatChartDate(item.date)),datasets: [{label: 'Carbon Footprint(tons CO₂/month)',data: carbonData.history.map(item=> item.value),borderColor: '#4CAF50',backgroundColor: 'rgba(76,175,80,0.1)',borderWidth: 3,fill: true,tension: 0.4,pointBackgroundColor: '#4CAF50',pointBorderColor: '#fff',pointBorderWidth: 2,pointRadius: 6,pointHoverRadius: 8}]},options:{responsive: true,maintainAspectRatio: false,plugins:{legend:{display: false},tooltip:{backgroundColor: 'rgba(0,0,0,0.8)',titleColor: '#fff',bodyColor: '#fff',callbacks:{label: function(context){return context.parsed.y+' tons CO₂/month';}}}},scales:{y:{beginAtZero: false,grid:{color: 'rgba(0,0,0,0.1)'},ticks:{callback: function(value){return value+'t';}}},x:{grid:{color: 'rgba(0,0,0,0.1)'}}},interaction:{intersect: false,mode: 'index'}}});}updateCarbonChart(timeRange){// In a real app,this would fetch different time ranges // For demo,we'll just update the chart with different data points const carbonData=this.dashboardData.stats.carbonFootprint;let dataPoints;switch(timeRange){case '7': dataPoints=carbonData.history.slice(-1);// Last 7 days(simplified)break;case '30': dataPoints=carbonData.history.slice(-4);// Last 30 days(simplified)break;case '90': dataPoints=carbonData.history;// Last 3 months break;default: dataPoints=carbonData.history;}this.carbonChart.data.labels=dataPoints.map(item=> this.formatChartDate(item.date));this.carbonChart.data.datasets[0].data=dataPoints.map(item=> item.value);this.carbonChart.update();}openAddGoalModal(){const modal=document.getElementById('addGoalModal');modal.style.display='block';// Set default target date to 3 months from now const defaultDate=new Date();defaultDate.setMonth(defaultDate.getMonth()+3);document.getElementById('goalTarget').value=defaultDate.toISOString().split('T')[0];}handleAddGoal(e){e.preventDefault();const title=document.getElementById('goalTitle').value.trim();const category=document.getElementById('goalCategory').value;const targetDate=document.getElementById('goalTarget').value;if(!title || !category || !targetDate){alert('Please fill in all fields');return;}const newGoal={id: `goal_${Date.now()}`,title,category,targetDate,progress: 0,status: 'in_progress',createdDate: new Date().toISOString().split('T')[0]};this.dashboardData.goals.unshift(newGoal);this.renderGoals();this.closeModals();// Reset form e.target.reset();this.showNotification('Goal added successfully!','success');}showAnimalDetails(animalId){// In a real app,this would navigate to animal details page const animal=this.dashboardData.favoriteAnimals.find(a=> a.id===animalId);if(animal){this.showNotification(`Learn more about ${animal.name}!`,'info');}}closeModals(){document.querySelectorAll('.modal').forEach(modal=>{modal.style.display='none';});}showNotification(message,type='info'){const notification=document.createElement('div');notification.className=`notification ${type}`;notification.innerHTML=` <i class="fas ${type==='success' ? 'fa-check-circle' : type==='error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i> ${message}`;notification.style.cssText=` position: fixed;top: 20px;right: 20px;background: ${type==='success' ? '#4CAF50' : type==='error' ? '#f44336' : '#2196F3'};color: white;padding: 15px 20px;border-radius: 8px;z-index: 1000;display: flex;align-items: center;gap: 10px;box-shadow: 0 4px 12px rgba(0,0,0,0.2);animation: slideInRight 0.3s ease;`;document.body.appendChild(notification);setTimeout(()=>{notification.style.animation='slideOutRight 0.3s ease';setTimeout(()=> notification.remove(),300);},3000);}// Utility functions formatDate(dateString){const date=new Date(dateString);const now=new Date();const diffTime=Math.abs(now-date);const diffDays=Math.floor(diffTime /(1000 * 60 * 60 * 24));if(diffDays===0){return 'Today';}else if(diffDays===1){return 'Yesterday';}else if(diffDays < 7){return `${diffDays}days ago`;}else{return date.toLocaleDateString();}}formatChartDate(dateString){const date=new Date(dateString);return date.toLocaleDateString([],{month: 'short',day: 'numeric'});}capitalizeFirst(string){return string.charAt(0).toUpperCase()+string.slice(1);}setupThemeToggle(){const themeToggle=document.getElementById('themeToggle');if(!themeToggle)return;// Load saved theme const savedTheme=localStorage.getItem('dashboard-theme');if(savedTheme==='light'){document.body.classList.add('light-theme');themeToggle.textContent='☀️';}else{themeToggle.textContent='🌙';}themeToggle.addEventListener('click',()=>{document.body.classList.toggle('light-theme');if(document.body.classList.contains('light-theme')){localStorage.setItem('dashboard-theme','light');themeToggle.textContent='☀️';}else{localStorage.setItem('dashboard-theme','dark');themeToggle.textContent='🌙';}});}}// Initialize dashboard when DOM is loaded document.addEventListener('DOMContentLoaded',()=>{window.ecoDashboard=new EcoDashboard();});
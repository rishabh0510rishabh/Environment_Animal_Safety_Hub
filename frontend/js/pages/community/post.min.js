//=========================// Global Variables //=========================const postsContainer=document.getElementById("posts-container");const loader=document.getElementById("loader");let postsData=[];let postIndex=0;//=========================// Load Posts from JSON //=========================async function loadPostsJSON(){try{const response=await fetch("../../assets/data/posts.json");postsData=await response.json();loadPost(3);}catch(err){console.error("Failed to load posts:",err);loader.innerText="Failed to load posts";}}//=========================// Render Posts //=========================function loadPost(count=3){if(postIndex >=postsData.length){loader.innerText="No more posts";return;}for(let i=0;i < count && postIndex < postsData.length;i++,postIndex++){const post=postsData[postIndex];const postCard=document.createElement("div");postCard.className="post-card";postCard.dataset.postId=`post-${postIndex}-${Date.now()}`;postCard.innerHTML=` <div class="post-header"> <img src="${post.avatar}" alt="${post.username}"> <div class="post-user-info"> <span class="username">${post.username}</span> ${post.lastUpdated ? `<span class="post-timestamp"> <i class="fa-regular fa-clock"></i> Last updated: ${post.lastUpdated}</span>` : ""}</div> </div> <div class="post-image"> <img src="${post.image}" alt="Post image"> </div> <div class="subheading post-desc">${post.desc}</div> <div class="post-actions"> <i class="fa-regular fa-heart like-btn"></i> <i class="fa-regular fa-comment comment-btn"></i> <i class="fa-regular fa-bookmark save-btn"></i> <i class="fa-solid fa-volume-high tts-btn" title="Read Aloud"></i> </div> <div class="post-stats"> <span class="likes-count">${post.likes}</span> likes • <span class="comments-count">${post.comments}</span> comments </div> <div class="emoji-reactions"> <div class="emoji-reaction"> <span class="emoji-icon">👍</span> <span class="emoji-count">0</span> </div> <div class="emoji-reaction"> <span class="emoji-icon">👎</span> <span class="emoji-count">0</span> </div> </div> <div class="comment-panel column" style="display:none;"> <div class="comments-list column"></div> <input class="input comment-input" placeholder="Write a comment..." /> <button class="btn add-comment-btn">Post</button> <p class="no-comment text-sm">No comments yet</p> </div> `;postsContainer.appendChild(postCard);attachPostListeners(postCard);}}//=========================// Post Interactions //=========================function attachPostListeners(postCard){const likeBtn=postCard.querySelector(".like-btn");const saveBtn=postCard.querySelector(".save-btn");const commentBtn=postCard.querySelector(".comment-btn");const ttsBtn=postCard.querySelector(".tts-btn");const postDesc=postCard.querySelector(".post-desc");const commentPanel=postCard.querySelector(".comment-panel");const commentInput=postCard.querySelector(".comment-input");const addCommentBtn=postCard.querySelector(".add-comment-btn");const commentsList=postCard.querySelector(".comments-list");const noComment=postCard.querySelector(".no-comment");const likesCount=postCard.querySelector(".likes-count");const commentsCount=postCard.querySelector(".comments-count");// Like likeBtn.addEventListener("click",()=>{likeBtn.classList.toggle("active");likeBtn.classList.replace(likeBtn.classList.contains("active")? "fa-regular" : "fa-solid",likeBtn.classList.contains("active")? "fa-solid" : "fa-regular");let likes=parseInt(likesCount.textContent);likesCount.textContent=likeBtn.classList.contains("active")? likes+1 : likes-1;});// Save saveBtn.addEventListener("click",()=>{saveBtn.classList.toggle("active");saveBtn.classList.replace(saveBtn.classList.contains("active")? "fa-regular" : "fa-solid",saveBtn.classList.contains("active")? "fa-solid" : "fa-regular");});// Toggle Comments commentBtn.addEventListener("click",()=>{commentPanel.style.display=commentPanel.style.display==="flex" ? "none" : "flex";updateNoComment();});// Add Comment addCommentBtn.addEventListener("click",()=>{const text=commentInput.value.trim();if(!text)return;const comment=document.createElement("div");comment.className="comment-item";comment.textContent=text;commentsList.appendChild(comment);commentsCount.textContent=parseInt(commentsCount.textContent)+1;commentInput.value="";updateNoComment();});// Text to Speech let utterance=null;ttsBtn.addEventListener("click",()=>{if(speechSynthesis.speaking){speechSynthesis.cancel();ttsBtn.classList.replace("fa-stop","fa-volume-high");return;}utterance=new SpeechSynthesisUtterance(postDesc.textContent);utterance.lang="en-US";utterance.onend=()=> ttsBtn.classList.replace("fa-stop","fa-volume-high");speechSynthesis.speak(utterance);ttsBtn.classList.replace("fa-volume-high","fa-stop");});function updateNoComment(){noComment.style.display=commentsList.children.length===0 ? "block" : "none";}updateNoComment();}//=========================// Infinite Scroll //=========================window.addEventListener("scroll",()=>{if(window.innerHeight+window.scrollY >=document.body.offsetHeight-100){loadPost();}});//=========================// Init //=========================loadPostsJSON();
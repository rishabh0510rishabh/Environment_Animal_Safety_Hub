<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Virtual Eco Garden - EcoLife</title>
  <link rel="stylesheet" href="../css/global/variables.css">
  <link rel="stylesheet" href="../css/global/utilities.css">
  <link rel="stylesheet" href="../css/components/navbar.css">
  <link rel="stylesheet" href="../css/components/footer.css">
  <link rel="stylesheet" href="../css/global/accessibility.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body { font-family: 'Poppins', sans-serif; margin: 0; background: linear-gradient(135deg, #87CEEB 0%, #98FB98 100%); min-height: 100vh; }
    .garden-hero { background: linear-gradient(135deg, #4CAF50, #2E7D32); color: white; padding: 60px 20px 40px; text-align: center; }
    .garden-hero h1 { font-size: 2.5rem; margin-bottom: 1rem; }
    .garden-hero p { font-size: 1.1rem; opacity: 0.9; }
    .garden-container { max-width: 1200px; margin: -20px auto 60px; padding: 0 20px; }
    .garden-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
    .stat-card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); text-align: center; }
    .stat-value { font-size: 2rem; font-weight: 600; color: #4CAF50; }
    .stat-label { color: #666; font-size: 0.9rem; }
    .garden-area { background: rgba(255,255,255,0.9); border-radius: 20px; padding: 30px; margin-bottom: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
    .garden-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 15px; margin: 20px 0; min-height: 400px; }
    .garden-plot { width: 80px; height: 80px; border: 3px dashed #8BC34A; border-radius: 12px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; position: relative; background: #F1F8E9; }
    .garden-plot:hover { border-color: #4CAF50; background: #E8F5E8; transform: scale(1.05); }
    .garden-plot.planted { border: 3px solid #4CAF50; background: #C8E6C9; }
    .plant { font-size: 2.5rem; animation: grow 0.5s ease-out; }
    .plant-info { position: absolute; bottom: -25px; left: 50%; transform: translateX(-50%); font-size: 0.7rem; color: #4CAF50; font-weight: 600; }
    .seed-shop { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 30px; }
    .seeds-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin-top: 20px; }
    .seed-card { text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px; cursor: pointer; transition: all 0.3s; border: 2px solid transparent; }
    .seed-card:hover { background: #4CAF50; color: white; transform: translateY(-3px); }
    .seed-card.selected { border-color: #4CAF50; background: #E8F5E8; }
    .seed-icon { font-size: 2rem; margin-bottom: 8px; }
    .seed-name { font-weight: 600; font-size: 0.9rem; }
    .seed-cost { color: #666; font-size: 0.8rem; }
    .actions-panel { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 30px; }
    .actions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
    .action-card { padding: 20px; background: #f8f9fa; border-radius: 8px; text-align: center; cursor: pointer; transition: all 0.3s; }
    .action-card:hover { background: #4CAF50; color: white; transform: translateY(-3px); }
    .action-icon { font-size: 2.5rem; margin-bottom: 10px; }
    .action-title { font-weight: 600; margin-bottom: 5px; }
    .action-reward { color: #4CAF50; font-size: 0.9rem; }
    .action-card:hover .action-reward { color: white; }
    .level-progress { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 30px; }
    .progress-bar { width: 100%; height: 20px; background: #e0e0e0; border-radius: 10px; overflow: hidden; margin: 10px 0; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #4CAF50, #8BC34A); transition: width 0.3s; }
    .achievements { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 15px; margin-top: 20px; }
    .achievement { text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px; }
    .achievement.unlocked { background: #4CAF50; color: white; }
    .achievement-icon { font-size: 2rem; margin-bottom: 8px; }
    .btn-primary { background: #4CAF50; color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s; min-height: 44px; }
    .btn-primary:hover { background: #45a049; transform: translateY(-2px); }
    .btn-secondary { background: white; color: #4CAF50; padding: 12px 24px; border: 2px solid #4CAF50; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s; min-height: 44px; }
    .btn-secondary:hover { background: #4CAF50; color: white; }
    .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 1000; }
    .modal-content { background: white; padding: 30px; border-radius: 12px; max-width: 500px; width: 90%; text-align: center; }
    .modal h3 { color: #2E7D32; margin-bottom: 15px; }
    .donation-info { background: #E8F5E8; padding: 20px; border-radius: 8px; margin: 20px 0; }
    @keyframes grow { from { transform: scale(0); } to { transform: scale(1); } }
    @keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-10px); } 60% { transform: translateY(-5px); } }
    .notification { position: fixed; top: 20px; right: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; z-index: 1001; transform: translateX(300px); transition: transform 0.3s; }
    .notification.show { transform: translateX(0); }
    @media (max-width: 768px) {
      .garden-hero h1 { font-size: 2rem; }
      .garden-grid { grid-template-columns: repeat(4, 1fr); }
      .garden-plot { width: 60px; height: 60px; }
      .plant { font-size: 2rem; }
    }
  </style>
</head>
<body>
  <div id="navbar-container"></div>

  <main>
    <section class="garden-hero">
      <h1>üå± Virtual Eco Garden</h1>
      <p>Plant, grow, and nurture your virtual garden while making real environmental impact!</p>
    </section>

    <div class="garden-container">
      <!-- Garden Stats -->
      <div class="garden-stats">
        <div class="stat-card">
          <div class="stat-value" id="totalPlants">0</div>
          <div class="stat-label">Plants Grown</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="ecoPoints">100</div>
          <div class="stat-label">Eco Points</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="currentLevel">1</div>
          <div class="stat-label">Garden Level</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="realTrees">0</div>
          <div class="stat-label">Real Trees Funded</div>
        </div>
      </div>

      <!-- Level Progress -->
      <div class="level-progress">
        <h3 style="color: #2E7D32; margin-bottom: 15px;"><i class="fas fa-trophy"></i> Level Progress</h3>
        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
          <span>Level <span id="levelDisplay">1</span></span>
          <span><span id="currentXP">0</span> / <span id="nextLevelXP">100</span> XP</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="levelProgress" style="width: 0%"></div>
        </div>
        <div class="achievements">
          <div class="achievement unlocked" id="achievement1">
            <div class="achievement-icon">üå±</div>
            <div>First Seed</div>
          </div>
          <div class="achievement" id="achievement2">
            <div class="achievement-icon">üå≥</div>
            <div>Tree Lover</div>
          </div>
          <div class="achievement" id="achievement3">
            <div class="achievement-icon">üèÜ</div>
            <div>Garden Master</div>
          </div>
          <div class="achievement" id="achievement4">
            <div class="achievement-icon">üåç</div>
            <div>Eco Warrior</div>
          </div>
        </div>
      </div>

      <!-- Garden Area -->
      <div class="garden-area">
        <h3 style="color: #2E7D32; margin-bottom: 15px; text-align: center;"><i class="fas fa-seedling"></i> Your Virtual Garden</h3>
        <div class="garden-grid" id="gardenGrid">
          <!-- Garden plots will be generated by JavaScript -->
        </div>
        <div style="text-align: center; margin-top: 20px;">
          <button class="btn-primary" onclick="waterAllPlants()">
            <i class="fas fa-tint"></i> Water All Plants
          </button>
          <button class="btn-secondary" onclick="shareGarden()">
            <i class="fas fa-share"></i> Share Garden
          </button>
        </div>
      </div>

      <!-- Seed Shop -->
      <div class="seed-shop">
        <h3 style="color: #2E7D32; margin-bottom: 15px;"><i class="fas fa-store"></i> Seed Shop</h3>
        <p>Select a seed to plant in your garden</p>
        <div class="seeds-grid">
          <div class="seed-card" data-seed="flower" data-cost="10">
            <div class="seed-icon">üå∏</div>
            <div class="seed-name">Flower</div>
            <div class="seed-cost">10 points</div>
          </div>
          <div class="seed-card" data-seed="tree" data-cost="25">
            <div class="seed-icon">üå≥</div>
            <div class="seed-name">Tree</div>
            <div class="seed-cost">25 points</div>
          </div>
          <div class="seed-card" data-seed="bush" data-cost="15">
            <div class="seed-icon">üåø</div>
            <div class="seed-name">Bush</div>
            <div class="seed-cost">15 points</div>
          </div>
          <div class="seed-card" data-seed="cactus" data-cost="20">
            <div class="seed-icon">üåµ</div>
            <div class="seed-name">Cactus</div>
            <div class="seed-cost">20 points</div>
          </div>
          <div class="seed-card" data-seed="sunflower" data-cost="30">
            <div class="seed-icon">üåª</div>
            <div class="seed-name">Sunflower</div>
            <div class="seed-cost">30 points</div>
          </div>
          <div class="seed-card" data-seed="rose" data-cost="35">
            <div class="seed-icon">üåπ</div>
            <div class="seed-name">Rose</div>
            <div class="seed-cost">35 points</div>
          </div>
        </div>
      </div>

      <!-- Real World Actions -->
      <div class="actions-panel">
        <h3 style="color: #2E7D32; margin-bottom: 15px;"><i class="fas fa-leaf"></i> Real World Actions</h3>
        <p>Complete these actions to earn points and water your plants!</p>
        <div class="actions-grid">
          <div class="action-card" onclick="completeAction('recycle', 20)">
            <div class="action-icon">‚ôªÔ∏è</div>
            <div class="action-title">Recycle Items</div>
            <div class="action-reward">+20 points</div>
          </div>
          <div class="action-card" onclick="completeAction('walk', 15)">
            <div class="action-icon">üö∂</div>
            <div class="action-title">Walk Instead of Drive</div>
            <div class="action-reward">+15 points</div>
          </div>
          <div class="action-card" onclick="completeAction('energy', 25)">
            <div class="action-icon">üí°</div>
            <div class="action-title">Save Energy</div>
            <div class="action-reward">+25 points</div>
          </div>
          <div class="action-card" onclick="completeAction('water', 10)">
            <div class="action-icon">üíß</div>
            <div class="action-title">Conserve Water</div>
            <div class="action-reward">+10 points</div>
          </div>
          <div class="action-card" onclick="completeAction('plant', 50)">
            <div class="action-icon">üå±</div>
            <div class="action-title">Plant Real Tree</div>
            <div class="action-reward">+50 points</div>
          </div>
          <div class="action-card" onclick="completeAction('cleanup', 30)">
            <div class="action-icon">üßπ</div>
            <div class="action-title">Beach Cleanup</div>
            <div class="action-reward">+30 points</div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Donation Modal -->
  <div class="modal" id="donationModal">
    <div class="modal-content">
      <h3>üå≥ Plant Real Trees!</h3>
      <p>Your virtual garden has grown enough to fund real tree planting!</p>
      <div class="donation-info">
        <p><strong>Every 10 virtual plants = 1 real tree planted</strong></p>
        <p>Your contribution helps reforestation efforts worldwide</p>
      </div>
      <button class="btn-primary" onclick="fundRealTree()">Fund Tree Planting</button>
      <button class="btn-secondary" onclick="closeModal()">Maybe Later</button>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification"></div>

  <div id="footer-container"></div>

  <script>
    // Game state
    let gameState = JSON.parse(localStorage.getItem('virtualGarden') || '{"plants": [], "points": 100, "level": 1, "xp": 0, "realTrees": 0}');
    let selectedSeed = null;

    // Plant types with growth stages
    const plantTypes = {
      flower: ['üå±', 'üåø', 'üå∏'],
      tree: ['üå±', 'üåø', 'üå≥'],
      bush: ['üå±', 'üåø', 'üåø'],
      cactus: ['üå±', 'üåµ', 'üåµ'],
      sunflower: ['üå±', 'üåø', 'üåª'],
      rose: ['üå±', 'üåø', 'üåπ']
    };

    // Load navbar and footer
    fetch('../components/navbar.html').then(r => r.text()).then(html => {
      document.getElementById('navbar-container').innerHTML = html;
    });
    fetch('../components/footer.html').then(r => r.text()).then(html => {
      document.getElementById('footer-container').innerHTML = html;
    });

    // Initialize garden
    function initGarden() {
      const grid = document.getElementById('gardenGrid');
      grid.innerHTML = '';
      
      for (let i = 0; i < 24; i++) {
        const plot = document.createElement('div');
        plot.className = 'garden-plot';
        plot.dataset.plotId = i;
        plot.onclick = () => plantSeed(i);
        
        const plant = gameState.plants.find(p => p.plotId === i);
        if (plant) {
          plot.classList.add('planted');
          const plantIcon = document.createElement('div');
          plantIcon.className = 'plant';
          plantIcon.textContent = plantTypes[plant.type][plant.stage];
          plot.appendChild(plantIcon);
          
          const info = document.createElement('div');
          info.className = 'plant-info';
          info.textContent = `Lv.${plant.stage + 1}`;
          plot.appendChild(info);
        }
        
        grid.appendChild(plot);
      }
      
      updateStats();
    }

    // Plant seed
    function plantSeed(plotId) {
      if (!selectedSeed) {
        showNotification('Please select a seed first!');
        return;
      }
      
      const existingPlant = gameState.plants.find(p => p.plotId === plotId);
      if (existingPlant) {
        showNotification('This plot is already planted!');
        return;
      }
      
      const seedCost = parseInt(document.querySelector(`[data-seed="${selectedSeed}"]`).dataset.cost);
      if (gameState.points < seedCost) {
        showNotification('Not enough points!');
        return;
      }
      
      gameState.points -= seedCost;
      gameState.plants.push({
        plotId,
        type: selectedSeed,
        stage: 0,
        plantedAt: Date.now(),
        lastWatered: Date.now()
      });
      
      addXP(10);
      saveGame();
      initGarden();
      showNotification(`${selectedSeed} planted! üå±`);
      
      // Clear selection
      document.querySelectorAll('.seed-card').forEach(card => card.classList.remove('selected'));
      selectedSeed = null;
    }

    // Select seed
    document.querySelectorAll('.seed-card').forEach(card => {
      card.onclick = function() {
        document.querySelectorAll('.seed-card').forEach(c => c.classList.remove('selected'));
        this.classList.add('selected');
        selectedSeed = this.dataset.seed;
      };
    });

    // Water all plants
    function waterAllPlants() {
      let watered = 0;
      gameState.plants.forEach(plant => {
        const timeSinceWatered = Date.now() - plant.lastWatered;
        if (timeSinceWatered > 3600000) { // 1 hour
          plant.lastWatered = Date.now();
          if (plant.stage < 2) {
            plant.stage++;
            watered++;
          }
        }
      });
      
      if (watered > 0) {
        addXP(watered * 5);
        saveGame();
        initGarden();
        showNotification(`Watered ${watered} plants! üíß`);
      } else {
        showNotification('Plants don\'t need water yet!');
      }
    }

    // Complete real world action
    function completeAction(action, points) {
      gameState.points += points;
      addXP(points);
      
      // Auto-water plants when completing actions
      gameState.plants.forEach(plant => {
        if (plant.stage < 2 && Math.random() > 0.5) {
          plant.stage++;
        }
      });
      
      saveGame();
      initGarden();
      showNotification(`Great job! +${points} points earned! üéâ`);
      
      // Check for tree donation
      if (gameState.plants.length >= 10 && gameState.plants.length % 10 === 0) {
        setTimeout(() => {
          document.getElementById('donationModal').style.display = 'flex';
        }, 1000);
      }
    }

    // Add XP and level up
    function addXP(xp) {
      gameState.xp += xp;
      const xpNeeded = gameState.level * 100;
      
      if (gameState.xp >= xpNeeded) {
        gameState.level++;
        gameState.xp = 0;
        showNotification(`Level Up! You're now level ${gameState.level}! üèÜ`);
        checkAchievements();
      }
    }

    // Check achievements
    function checkAchievements() {
      const achievements = {
        achievement2: gameState.plants.filter(p => p.type === 'tree').length >= 5,
        achievement3: gameState.level >= 5,
        achievement4: gameState.realTrees >= 3
      };
      
      Object.entries(achievements).forEach(([id, unlocked]) => {
        if (unlocked) {
          document.getElementById(id).classList.add('unlocked');
        }
      });
    }

    // Fund real tree
    function fundRealTree() {
      gameState.realTrees++;
      gameState.points += 100; // Bonus for funding
      addXP(100);
      saveGame();
      updateStats();
      closeModal();
      showNotification('Thank you for funding a real tree! üå≥');
    }

    // Share garden
    function shareGarden() {
      const text = `I've grown ${gameState.plants.length} plants in my Virtual Eco Garden and funded ${gameState.realTrees} real trees! üå±üå≥ Join me at EcoLife!`;
      
      if (navigator.share) {
        navigator.share({
          title: 'My Virtual Eco Garden',
          text: text,
          url: window.location.href
        });
      } else {
        navigator.clipboard.writeText(text + ' ' + window.location.href);
        showNotification('Garden progress copied to clipboard! üìã');
      }
    }

    // Update stats display
    function updateStats() {
      document.getElementById('totalPlants').textContent = gameState.plants.length;
      document.getElementById('ecoPoints').textContent = gameState.points;
      document.getElementById('currentLevel').textContent = gameState.level;
      document.getElementById('realTrees').textContent = gameState.realTrees;
      document.getElementById('levelDisplay').textContent = gameState.level;
      document.getElementById('currentXP').textContent = gameState.xp;
      document.getElementById('nextLevelXP').textContent = gameState.level * 100;
      
      const progressPercent = (gameState.xp / (gameState.level * 100)) * 100;
      document.getElementById('levelProgress').style.width = progressPercent + '%';
    }

    // Show notification
    function showNotification(message) {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.classList.add('show');
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }

    // Close modal
    function closeModal() {
      document.getElementById('donationModal').style.display = 'none';
    }

    // Save game state
    function saveGame() {
      localStorage.setItem('virtualGarden', JSON.stringify(gameState));
    }

    // Auto-grow plants over time
    setInterval(() => {
      let grown = false;
      gameState.plants.forEach(plant => {
        const timeSincePlanted = Date.now() - plant.plantedAt;
        const timeSinceWatered = Date.now() - plant.lastWatered;
        
        // Auto-grow if watered recently and enough time passed
        if (timeSinceWatered < 7200000 && timeSincePlanted > 1800000 && plant.stage < 2 && Math.random() > 0.8) {
          plant.stage++;
          grown = true;
        }
      });
      
      if (grown) {
        saveGame();
        initGarden();
      }
    }, 30000); // Check every 30 seconds

    // Initialize
    initGarden();
    checkAchievements();
  </script>
</body>
</html>

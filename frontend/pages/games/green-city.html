<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green City Builder - Eco Planner</title>
    <link rel="stylesheet" href="../../css/pages/games/green-city.css">
    <link rel="stylesheet" href="../../css/global/variables.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/components/navbar.css" />
    <link rel="stylesheet" href="../../css/components/footer.css" />
    <link rel="stylesheet" href="../../css/global/utilities.css" />
</head>
<body>
    <div id="cursor-container"></div>
    <script src="../../js/components/loadComponents.js"></script>

    <div id="navbar-container"></div>
    
    <!-- Intro Screen -->
    <div id="introScreen" class="screen active">
        <div class="intro-container">
            <h1 class="game-title">ğŸŒ† Green City Builder</h1>
            <p class="game-subtitle">Master the Art of Sustainable Urban Planning</p>
            <div class="game-description">
                <p>Build a thriving metropolis where <strong>energy</strong> meets <strong>ecology</strong></p>
                <p>Balance power generation, carbon emissions, and your budget to achieve sustainability</p>
            </div>
            <div class="difficulty-selection">
                <h3>Select Difficulty:</h3>
                <div class="difficulty-buttons">
                    <button class="btn-difficulty" data-difficulty="easy">
                        <span class="diff-icon">ğŸŒ±</span>
                        <span class="diff-name">Easy</span>
                        <span class="diff-desc">Budget: 500 | Target: Eâ‰¥100</span>
                    </button>
                    <button class="btn-difficulty" data-difficulty="medium">
                        <span class="diff-icon">ğŸ™ï¸</span>
                        <span class="diff-name">Medium</span>
                        <span class="diff-desc">Budget: 400 | Target: Eâ‰¥100, Câ‰¤80</span>
                    </button>
                    <button class="btn-difficulty" data-difficulty="hard">
                        <span class="diff-icon">ğŸŒ</span>
                        <span class="diff-name">Hard</span>
                        <span class="diff-desc">Budget: 300 | Target: Eâ‰¥100, Câ‰¤50</span>
                    </button>
                </div>
            </div>
            <button class="btn-secondary" id="instructionsBtn">ğŸ“– How to Play</button>
        </div>
    </div>

    <!-- Instructions Modal -->
    <div id="instructionsModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ğŸ“ Eco-Planner's Guide</h2>
            <div class="instructions-grid">
                <div class="instruction-card">
                    <div class="inst-icon">âš¡</div>
                    <h3>Energy Target</h3>
                    <p>Reach <strong>100 Energy Points</strong> to power your city. Use Solar Panels, Wind Turbines, and (carefully) Factories.</p>
                </div>
                <div class="instruction-card">
                    <div class="inst-icon">ğŸŒ¿</div>
                    <h3>Carbon Control</h3>
                    <p>Keep Carbon below <strong>100</strong>. Factories pollute, Forests absorb carbon. Balance is key!</p>
                </div>
                <div class="instruction-card">
                    <div class="inst-icon">ğŸ’°</div>
                    <h3>Budget Management</h3>
                    <p>Each tile costs money. Plan wisely! Running out of budget before reaching 100 Energy = Game Over.</p>
                </div>
                <div class="instruction-card">
                    <div class="inst-icon">ğŸ¯</div>
                    <h3>Adjacency Bonus</h3>
                    <p><strong>Elite Strategy:</strong> Placing Forests next to Factories reduces their carbon by 10%. Solar Panels near Water get +20% energy!</p>
                </div>
                <div class="instruction-card">
                    <div class="inst-icon">ğŸ“Š</div>
                    <h3>Eco-Rating</h3>
                    <p><strong>S-Rank:</strong> Eâ‰¥100, Câ‰¤20, Budget>50<br><strong>A-Rank:</strong> Eâ‰¥100, Câ‰¤50<br><strong>B-Rank:</strong> Eâ‰¥100, Câ‰¤80</p>
                </div>
                <div class="instruction-card">
                    <div class="inst-icon">ğŸ†</div>
                    <h3>Victory Path</h3>
                    <p>Achieve 100+ Energy while keeping Carbon under control. Master the grid, become a Sustainability Hero!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="screen">
        <!-- Top HUD -->
        <div class="game-hud">
            <div class="hud-left">
                <button class="btn-back" id="backBtn">â† Kids Zone</button>
                <div class="difficulty-badge" id="difficultyBadge">Medium</div>
            </div>
            
            <div class="hud-meters">
                <div class="meter-card energy">
                    <div class="meter-header">
                        <span class="meter-icon">âš¡</span>
                        <span class="meter-label">Energy</span>
                        <span class="meter-value" id="energyValue">0 / 100</span>
                    </div>
                    <div class="meter-bar">
                        <div class="meter-fill energy-fill" id="energyFill"></div>
                    </div>
                </div>
                
                <div class="meter-card carbon">
                    <div class="meter-header">
                        <span class="meter-icon">ğŸŒ¿</span>
                        <span class="meter-label">Carbon</span>
                        <span class="meter-value" id="carbonValue">0 / 100</span>
                    </div>
                    <div class="meter-bar">
                        <div class="meter-fill carbon-fill" id="carbonFill"></div>
                    </div>
                </div>
                
                <div class="meter-card budget">
                    <div class="meter-header">
                        <span class="meter-icon">ğŸ’°</span>
                        <span class="meter-label">Budget</span>
                        <span class="meter-value" id="budgetValue">500</span>
                    </div>
                    <div class="meter-bar">
                        <div class="meter-fill budget-fill" id="budgetFill"></div>
                    </div>
                </div>
            </div>
            
            <div class="hud-right">
                <button class="btn-reset" id="resetBtn">ğŸ”„ Reset</button>
            </div>
        </div>

        <!-- Main Game Area -->
        <div class="game-main">
            <!-- Tile Shop Sidebar -->
            <div class="tile-shop">
                <h3 class="shop-title">ğŸ—ï¸ Building Shop</h3>
                <div class="shop-divider"></div>
                
                <div class="tile-category">
                    <h4 class="category-title">âš¡ Power Generation</h4>
                    <div class="tile-item" data-type="solar">
                        <div class="tile-preview">â˜€ï¸</div>
                        <div class="tile-info">
                            <div class="tile-name">Solar Panel</div>
                            <div class="tile-stats">
                                <span class="stat-energy">+15 âš¡</span>
                                <span class="stat-carbon">+2 ğŸŒ¿</span>
                            </div>
                            <div class="tile-cost">ğŸ’° 50</div>
                        </div>
                    </div>
                    
                    <div class="tile-item" data-type="wind">
                        <div class="tile-preview">ğŸ’¨</div>
                        <div class="tile-info">
                            <div class="tile-name">Wind Turbine</div>
                            <div class="tile-stats">
                                <span class="stat-energy">+20 âš¡</span>
                                <span class="stat-carbon">+3 ğŸŒ¿</span>
                            </div>
                            <div class="tile-cost">ğŸ’° 70</div>
                        </div>
                    </div>
                    
                    <div class="tile-item" data-type="factory">
                        <div class="tile-preview">ğŸ­</div>
                        <div class="tile-info">
                            <div class="tile-name">Factory</div>
                            <div class="tile-stats">
                                <span class="stat-energy">+40 âš¡</span>
                                <span class="stat-carbon">+30 ğŸŒ¿</span>
                            </div>
                            <div class="tile-cost">ğŸ’° 60</div>
                        </div>
                    </div>
                </div>
                
                <div class="tile-category">
                    <h4 class="category-title">ğŸŒ± Eco Solutions</h4>
                    <div class="tile-item" data-type="forest">
                        <div class="tile-preview">ğŸŒ³</div>
                        <div class="tile-info">
                            <div class="tile-name">Forest</div>
                            <div class="tile-stats">
                                <span class="stat-energy">+0 âš¡</span>
                                <span class="stat-carbon">-15 ğŸŒ¿</span>
                            </div>
                            <div class="tile-cost">ğŸ’° 40</div>
                        </div>
                    </div>
                    
                    <div class="tile-item" data-type="water">
                        <div class="tile-preview">ğŸ’§</div>
                        <div class="tile-info">
                            <div class="tile-name">Water Body</div>
                            <div class="tile-stats">
                                <span class="stat-energy">+0 âš¡</span>
                                <span class="stat-carbon">-8 ğŸŒ¿</span>
                            </div>
                            <div class="tile-cost">ğŸ’° 30</div>
                        </div>
                    </div>
                    
                    <div class="tile-item" data-type="park">
                        <div class="tile-preview">ğŸï¸</div>
                        <div class="tile-info">
                            <div class="tile-name">City Park</div>
                            <div class="tile-stats">
                                <span class="stat-energy">+0 âš¡</span>
                                <span class="stat-carbon">-5 ğŸŒ¿</span>
                            </div>
                            <div class="tile-cost">ğŸ’° 25</div>
                        </div>
                    </div>
                </div>
                
                <div class="shop-divider"></div>
                
                <div class="adjacency-hints">
                    <h4 class="hints-title">ğŸ’¡ Pro Tips</h4>
                    <div class="hint-item">ğŸŒ³ next to ğŸ­ = -10% carbon</div>
                    <div class="hint-item">â˜€ï¸ next to ğŸ’§ = +20% energy</div>
                    <div class="hint-item">ğŸ’¨ near ğŸï¸ = +15% energy</div>
                </div>
            </div>

            <!-- 5x5 Grid -->
            <div class="grid-container">
                <div class="grid-wrapper">
                    <div id="cityGrid" class="city-grid"></div>
                </div>
                
                <div class="grid-info">
                    <div class="info-card">
                        <div class="info-label">Selected Tile:</div>
                        <div class="info-value" id="selectedTile">None</div>
                    </div>
                    <div class="info-card">
                        <div class="info-label">Grid Utilization:</div>
                        <div class="info-value" id="gridUtil">0 / 25</div>
                    </div>
                </div>
            </div>

            <!-- Strategy Panel -->
            <div class="strategy-panel">
                <h3 class="strategy-title">ğŸ“ˆ City Analytics</h3>
                <div class="shop-divider"></div>
                
                <div class="analytics-grid">
                    <div class="analytic-card">
                        <div class="analytic-icon">â˜€ï¸</div>
                        <div class="analytic-info">
                            <div class="analytic-label">Solar Panels</div>
                            <div class="analytic-value" id="solarCount">0</div>
                        </div>
                    </div>
                    
                    <div class="analytic-card">
                        <div class="analytic-icon">ğŸ’¨</div>
                        <div class="analytic-info">
                            <div class="analytic-label">Wind Turbines</div>
                            <div class="analytic-value" id="windCount">0</div>
                        </div>
                    </div>
                    
                    <div class="analytic-card">
                        <div class="analytic-icon">ğŸ­</div>
                        <div class="analytic-info">
                            <div class="analytic-label">Factories</div>
                            <div class="analytic-value" id="factoryCount">0</div>
                        </div>
                    </div>
                    
                    <div class="analytic-card">
                        <div class="analytic-icon">ğŸŒ³</div>
                        <div class="analytic-info">
                            <div class="analytic-label">Forests</div>
                            <div class="analytic-value" id="forestCount">0</div>
                        </div>
                    </div>
                </div>
                
                <div class="shop-divider"></div>
                
                <div class="current-stats">
                    <h4 class="stats-title">âš–ï¸ Balance Score</h4>
                    <div class="balance-meter">
                        <div class="balance-fill" id="balanceMeter"></div>
                    </div>
                    <div class="balance-text" id="balanceText">0% Sustainable</div>
                </div>
                
                <div class="shop-divider"></div>
                
                <div class="eco-rating">
                    <h4 class="rating-title">ğŸ† Current Rating</h4>
                    <div class="rating-display" id="ecoRating">-</div>
                    <div class="rating-desc" id="ratingDesc">Place tiles to get rated</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Victory Screen -->
    <div id="victoryScreen" class="screen">
        <div class="result-container victory">
            <div class="result-icon">ğŸ†</div>
            <h1 class="result-title">Sustainability Hero!</h1>
            <div class="result-message">
                <p>You've built a thriving green metropolis!</p>
                <div class="final-stats">
                    <div class="final-stat">
                        <span class="final-label">Energy Generated:</span>
                        <span class="final-value" id="finalEnergy">0</span>
                    </div>
                    <div class="final-stat">
                        <span class="final-label">Carbon Footprint:</span>
                        <span class="final-value" id="finalCarbon">0</span>
                    </div>
                    <div class="final-stat">
                        <span class="final-label">Budget Remaining:</span>
                        <span class="final-value" id="finalBudget">0</span>
                    </div>
                    <div class="final-stat rating">
                        <span class="final-label">Eco-Planner Rating:</span>
                        <span class="final-value grade" id="finalRating">A</span>
                    </div>
                </div>
            </div>
            <div class="result-buttons">
                <button class="btn-primary" id="playAgainVictory">Play Again</button>
                <button class="btn-secondary" id="mainMenuVictory">Main Menu</button>
            </div>
        </div>
    </div>

    <!-- Game Over Screen -->
    <div id="gameOverScreen" class="screen">
        <div class="result-container gameover">
            <div class="result-icon">ğŸ’€</div>
            <h1 class="result-title">City Collapse!</h1>
            <div class="result-message">
                <p id="gameOverReason">Your city has failed...</p>
                <div class="final-stats">
                    <div class="final-stat">
                        <span class="final-label">Energy Reached:</span>
                        <span class="final-value" id="gameOverEnergy">0</span>
                    </div>
                    <div class="final-stat">
                        <span class="final-label">Carbon Level:</span>
                        <span class="final-value" id="gameOverCarbon">0</span>
                    </div>
                    <div class="final-stat">
                        <span class="final-label">Budget Used:</span>
                        <span class="final-value" id="gameOverBudget">0</span>
                    </div>
                </div>
            </div>
            <div class="result-buttons">
                <button class="btn-primary" id="playAgainGameOver">Try Again</button>
                <button class="btn-secondary" id="mainMenuGameOver">Main Menu</button>
            </div>
        </div>
    </div>
    <!-- Footer placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Load components - SIMPLIFIED VERSION -->
    <!-- Remove footer-loader.js since it's deprecated and might conflict -->
    <script src="../../js/components/component-loader.js"></script>
    <script src="../../js/components/navbar-loader.js"></script>

    <!-- Load AOS animation library -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <!-- Initialize AOS -->
    <script>
        AOS.init({
            duration: 800,
            offset: 100,
            once: true
        });
    </script>

    <!-- Load your scripts -->
    <script src="../../js/main.js"></script>
    <script src="../../js/global/theme-toggle.js"></script>
    <script src="../../js/pages/games/green-city.js"></script>

    <!-- Chatbase script -->
    <script>
        (function () { 
            if (!window.chatbase || window.chatbase("getState") !== "initialized") { 
                window.chatbase = (...arguments) => { 
                    if (!window.chatbase.q) { 
                        window.chatbase.q = [] 
                    } 
                    window.chatbase.q.push(arguments) 
                }; 
                window.chatbase = new Proxy(window.chatbase, { 
                    get(target, prop) { 
                        if (prop === "q") { 
                            return target.q 
                        } 
                        return (...args) => target(prop, ...args) 
                    } 
                }) 
            } 
            const onLoad = function () { 
                const script = document.createElement("script"); 
                script.src = "https://www.chatbase.co/embed.min.js"; 
                script.id = "ws110ZzXAkEnbVsIy9g8d"; 
                script.domain = "www.chatbase.co"; 
                document.body.appendChild(script) 
            }; 
            if (document.readyState === "complete") { 
                onLoad() 
            } else { 
                window.addEventListener("load", onLoad) 
            } 
        })();
    </script>
</body>
</html>
